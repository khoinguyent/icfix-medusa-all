import{u as A}from"./chunk-C76H5USB-CNsijrNt.js";import{u as C,_ as D}from"./chunk-7VJK6HNE-BUd8UZcA.js";import{r as i,af as F,ah as L,j as r,b as _,am as R,an as U,ey as z,H as I,J as H,y as u,z as B,B as $,C as q,a4 as h,br as p,a2 as y,f as J,A as K,bi as V,T as Q,h as W,bt as G}from"./index-sa816enF.js";import"./chunk-Z26G6WFJ-BI2Bs95y.js";import{K as X}from"./chunk-6HTZNHPT-xixTBg0F.js";import{R as f}from"./chunk-4TC5YS65-CPc1BBnN.js";import{u as Y,a as Z,b as ee,c as re}from"./chunk-RLY2SL5E-DwFafPWU.js";import{T as ae}from"./Trans-C0b5l_0U.js";import{A as te}from"./alert-TviGbv0F.js";import"./chunk-YEDAFXMB-BMp4-sM8.js";import"./chunk-M3VFKDXJ-CrpKvMQU.js";import"./chunk-AOFGTNG6-BfmhQM-_.js";import"./chunk-EMIHDNB7-DmmqC3tj.js";import"./chunk-PFKKVLZX-DRRidV6_.js";import"./_isIndex-DeJVxHDd.js";import"./index-DOltNHC-.js";var se=Object.defineProperty,x=Object.getOwnPropertySymbols,M=Object.prototype.hasOwnProperty,N=Object.prototype.propertyIsEnumerable,P=(e,a,t)=>a in e?se(e,a,{enumerable:!0,configurable:!0,writable:!0,value:t}):e[a]=t,ne=(e,a)=>{for(var t in a)M.call(a,t)&&P(e,t,a[t]);if(x)for(var t of x(a))N.call(a,t)&&P(e,t,a[t]);return e},ie=(e,a)=>{var t={};for(var s in e)M.call(e,s)&&a.indexOf(s)<0&&(t[s]=e[s]);if(e!=null&&x)for(var s of x(e))a.indexOf(s)<0&&N.call(e,s)&&(t[s]=e[s]);return t};const S=i.forwardRef((e,a)=>{var t=e,{color:s="currentColor"}=t,n=ie(t,["color"]);return i.createElement("svg",ne({xmlns:"http://www.w3.org/2000/svg",width:15,height:15,fill:"none",ref:a},n),i.createElement("g",{stroke:s,strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:1.5,clipPath:"url(#a)"},i.createElement("path",{d:"m6.44 3.965 1.59-1.591a3.25 3.25 0 1 1 4.597 4.596l-1.591 1.59M3.964 6.44l-1.59 1.59a3.25 3.25 0 1 0 4.596 4.597l1.59-1.591M5.909 9.09 9.091 5.91"})),i.createElement("defs",null,i.createElement("clipPath",{id:"a"},i.createElement("path",{fill:"#fff",d:"M0 0h15v15H0z"}))))});S.displayName="Link";var oe=({prefix:e,pageSize:a=20})=>{const t=A(["offset","q","order","created_at","updated_at"],e),{offset:s,created_at:n,updated_at:o,q:l,order:c}=t;return{searchParams:{limit:a,offset:s?Number(s):0,order:c,created_at:n?JSON.parse(n):void 0,updated_at:o?JSON.parse(o):void 0,q:l},raw:t}},le=F({email:L().email()}),j=10,g="usr_invite",ce=`${window.location.origin}/invite?token=`,de=()=>{const{t:e}=_(),a=R({defaultValues:{email:""},resolver:U(le)}),{raw:t,searchParams:s}=oe({prefix:g,pageSize:j}),{invites:n,count:o,isPending:l,isError:c,error:d}=Y(s),w=ue(),{table:E}=C({data:n??[],columns:w,count:o,enablePagination:!0,getRowId:m=>m.id,pageSize:j,prefix:g}),{mutateAsync:O,isPending:k}=Z(),T=a.handleSubmit(async m=>{try{await O({email:m.email}),a.reset()}catch(v){if(z(v)&&v.status===400){a.setError("root",{type:"manual",message:v.message});return}}});if(c)throw d;return r.jsx(f.Form,{form:a,children:r.jsxs(X,{onSubmit:T,className:"flex h-full flex-col overflow-hidden",children:[r.jsx(f.Header,{}),r.jsx(f.Body,{className:"flex flex-1 flex-col overflow-hidden",children:r.jsx("div",{className:"flex flex-1 flex-col items-center overflow-y-auto",children:r.jsxs("div",{className:"flex w-full max-w-[720px] flex-col gap-y-8 px-2 py-16",children:[r.jsxs("div",{children:[r.jsx(I,{children:e("users.inviteUser")}),r.jsx(H,{size:"small",className:"text-ui-fg-subtle",children:e("users.inviteUserHint")})]}),a.formState.errors.root&&r.jsx(te,{variant:"error",dismissible:!1,className:"text-balance",children:a.formState.errors.root.message}),r.jsxs("div",{className:"flex flex-col gap-y-4",children:[r.jsx("div",{className:"grid grid-cols-2 gap-4",children:r.jsx(u.Field,{control:a.control,name:"email",render:({field:m})=>r.jsxs(u.Item,{children:[r.jsx(u.Label,{children:e("fields.email")}),r.jsx(u.Control,{children:r.jsx(B,{...m})}),r.jsx(u.ErrorMessage,{})]})})}),r.jsx("div",{className:"flex items-center justify-end",children:r.jsx($,{size:"small",variant:"secondary",type:"submit",isLoading:k,children:e("users.sendInvite")})})]}),r.jsxs("div",{className:"flex flex-col gap-y-4",children:[r.jsx(I,{level:"h2",children:e("users.pendingInvites")}),r.jsx(q,{className:"overflow-hidden p-0",children:r.jsx(D,{table:E,columns:w,count:o,pageSize:j,pagination:!0,search:"autofocus",isLoading:l,queryObject:t,prefix:g,orderBy:[{key:"email",label:e("fields.email")},{key:"created_at",label:e("fields.createdAt")},{key:"updated_at",label:e("fields.updatedAt")}]})})]})]})})})]})})},me=({invite:e})=>{const{mutateAsync:a}=ee(e.id),{mutateAsync:t}=re(e.id),s=J(),{t:n}=_(),o=async()=>{await s({title:n("general.areYouSure"),description:n("users.deleteInviteWarning",{email:e.email}),cancelText:n("actions.cancel"),confirmText:n("actions.delete")})&&await a()},l=async()=>{await t()},c=()=>{const d=`${ce}${e.token}`;G(d)};return r.jsx(K,{groups:[{actions:[{icon:r.jsx(V,{}),label:n("users.resendInvite"),onClick:l}]},{actions:[{icon:r.jsx(S,{}),label:n("users.copyInviteLink"),onClick:c}]},{actions:[{icon:r.jsx(Q,{}),label:n("actions.delete"),onClick:o}]}]})},b=W(),ue=()=>{const{t:e}=_();return i.useMemo(()=>[b.accessor("email",{header:e("fields.email"),cell:({getValue:a})=>a()}),b.accessor("accepted",{header:e("fields.status"),cell:({getValue:a,row:t})=>{const s=a(),n=new Date(t.original.expires_at)<new Date;return s?r.jsx(h,{content:e("users.acceptedOnDate",{date:p(new Date(t.original.updated_at),"dd MMM, yyyy")}),children:r.jsx(y,{color:"green",children:e("users.inviteStatus.accepted")})}):n?r.jsx(h,{content:e("users.expiredOnDate",{date:p(new Date(t.original.expires_at),"dd MMM, yyyy")}),children:r.jsx(y,{color:"red",children:e("users.inviteStatus.expired")})}):r.jsx(h,{content:r.jsx(ae,{i18nKey:"users.validFromUntil",components:[r.jsx("span",{className:"font-medium"},"from"),r.jsx("span",{className:"font-medium"},"untill")],values:{from:p(new Date(t.original.created_at),"dd MMM, yyyy"),until:p(new Date(t.original.expires_at),"dd MMM, yyyy")}}),children:r.jsx(y,{color:"orange",children:e("users.inviteStatus.pending")})})}}),b.display({id:"actions",cell:({row:a})=>r.jsx(me,{invite:a.original})})],[e])},Ee=()=>r.jsx(f,{children:r.jsx(de,{})});export{Ee as Component};
